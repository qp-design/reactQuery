(this.webpackJsonpmri=this.webpackJsonpmri||[]).push([[0],{195:function(e,n,t){},215:function(e,n,t){},216:function(e,n,t){},217:function(e,n,t){},219:function(e,n,t){},220:function(e,n,t){},221:function(e,n,t){},322:function(e,n,t){},323:function(e,n,t){},324:function(e,n,t){},325:function(e,n,t){},326:function(e,n,t){},327:function(e,n,t){},328:function(e,n,t){},329:function(e,n,t){},330:function(e,n,t){},331:function(e,n,t){"use strict";t.r(n);var c=t(1),l=t.n(c),i=t(17),s=t.n(i),a=t(9),r=t(132),o=(t(49),t(21)),d=t.n(o),u=t(48),j=t(6),v=(t(95),t(90)),b=t.n(v),O=(t(82),t(41)),x=t.n(O),h=function(e){if(e){var n=e.split(":");return 60*parseInt(n[0])+parseInt(n[1])}},m=function(e){var n=Math.floor(e%3600);return(Math.floor(e/3600)>0?Math.floor(e/3600)+":":"")+(Math.floor(n/60)>9?Math.floor(n/60)+":":"0"+Math.floor(n/60)+":")+(Math.floor(e%60>9?e%60:"0"+e%60)>9?Math.floor(e%60>9?e%60:"0"+e%60):"0"+Math.floor(e%60>9?e%60:"0"+e%60))},f=function(e,n){return m(Math.floor(h(e)*(100-n)/100))},p="ws://192.168.101.163:8000/api/ws/scan",g=t(0),N=Object(c.createContext)(null);N.displayName="wsContent";var w=function(e){var n=e.children,t=Object(c.useState)(null),l=Object(j.a)(t,2),i=l[0],s=l[1],a=Object(c.useState)(null),r=Object(j.a)(a,2),o=r[0],d=r[1],u=Object(c.useState)(null),v=Object(j.a)(u,2),b=v[0],O=v[1],x=Object(c.useState)([]),h=Object(j.a)(x,2),m=h[0],f=h[1],w=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=new WebSocket(p);e.onopen=function(n){w.current=e.send.bind(this)},e.onclose=function(n){console.log(n),e=new WebSocket(p)},e.onerror=function(){console.log("error")},e.onmessage=function(e){var n=JSON.parse(e.data);200===n.code&&(s(n.data),d((function(e){var t;return(null===(t=n.data)||void 0===t?void 0:t.state)||e})))}}),[]),Object(g.jsx)(N.Provider,{value:{wsDataSource:i,routerPath:o,setRouterPath:d,formValue:b,setFormValue:O,sendRef:w,result:m,setResult:f},children:n})};function S(){var e=Object(c.useContext)(N);if(!e)throw new Error("useWsContext\u5fc5\u987b\u5728EncapsulationContext\u4e2d\u4f7f\u7528");return e}t(195);var C=x.a.alert,y=function(e){var n=Object(a.f)(),t=S(),c=t.sendRef,l=(t.setFormValue,t.setRouterPath);return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"warp",children:[e.prev?Object(g.jsx)("div",{className:"prev",onClick:function(){n.goBack()},children:Object(g.jsx)(b.a,{type:"left",className:"icon",size:"sm",color:"#fff"})}):null,e["title-lg"]?Object(g.jsx)("div",{className:"title-lg",children:e["title-lg"]}):null,e["title-sm"]?Object(g.jsx)("div",{className:"title-sm",children:e["title-sm"]}):null,e.close?Object(g.jsxs)("div",{className:"close",onClick:function(){C("\u505c\u6b62\u626b\u63cf","\u534f\u8bae\u5c1a\u672a\u5b8c\u6210\u626b\u63cf\uff0c\u6b64\u65f6\u626b\u63cf\u5173\u95ed\u5c06\u4f1a\u4e22\u5931\u672c\u6b21\u626b\u63cf\u6570\u636e",[{text:"\u53d6\u6d88",style:"default"},{text:"\u5173\u95ed\u626b\u63cf",onPress:function(){var n;null===(n=c.current)||void 0===n||n.call(c,function(e){var n={action:"stop",userid:e};return JSON.stringify(n)}(e.uid)),l("Prepare")}}])},children:[Object(g.jsx)("img",{src:"/off.png",alt:""}),Object(g.jsx)("span",{children:"\u5173\u95ed\u626b\u63cf"})]}):null,e.loading?Object(g.jsx)("div",{className:"loadingWrap",children:Object(g.jsx)("div",{className:"loading",style:{width:e.loading+"%"}})}):null,e.timer?Object(g.jsxs)("div",{className:"timerWrap",children:[Object(g.jsxs)("span",{children:[e.timerTitle," "]}),Object(g.jsx)("b",{children:e.timerNum})]}):null,e.children]})})},I=[{name:"\u7537",id:"male",img:"/male"},{name:"\u5973",id:"female",img:"/female"}],E=function(e){var n=e.index,t=e.item,c=e.sex,l=e.changeGender,i=function(e){l(e.currentTarget.dataset.sex,t,n)};return Object(g.jsx)("ul",{children:I.map((function(e){return Object(g.jsxs)("li",{onClick:i,"data-sex":e.id,children:[Object(g.jsx)("img",{src:e.img+("male"===c?1:2)+".png",alt:e.name}),Object(g.jsx)("span",{children:e.name})]},e.id)}))})},k=[{isError:!1,id:1,type:"input",label:"\u59d3\u540d",name:"name",placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d",maxLength:15,require:!0,defaultValue:"",message:"\u8bf7\u8f93\u51655\u5b57\u4ee5\u5185\u7684\u59d3\u540d",validator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.length>0}},{isError:!1,id:2,type:"input",label:"\u624b\u673a\u53f7",name:"phonenum",placeholder:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",maxLength:11,require:!0,defaultValue:"",message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",validator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/.test(e)}},{isError:!1,id:3,type:"input",name:"age",label:"\u5e74\u9f84",maxLength:3,placeholder:"\u8bf7\u8f93\u5165\u5e74\u9f84(6-120\u5c81)",require:!0,defaultValue:"",message:"\u8bf7\u8f93\u51656-120\u7684\u6570\u5b57",validator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!isNaN(e)&&e>5&&e<121}},{isError:!1,id:4,type:"input",name:"weight",label:"\u4f53\u91cd",maxLength:3,placeholder:"\u8bf7\u8f93\u5165\u4f53\u91cd(\u5355\u4f4d:\u516c\u65a4)",require:!0,defaultValue:"",message:"\u8bf7\u8f93\u51651-100\u7684\u6570\u5b57",validator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!isNaN(e)&&e>0&&e<101}},{isError:!1,id:5,type:"slot",name:"sex",label:"\u6027\u522b",defaultValue:"male"}],T=t(136),L=t.n(T).a.create({baseURL:"",timeout:6e4,headers:{"Content-Type":"application/json"}});L.interceptors.request.use((function(e){var n="get"===e.method.toLowerCase()?"params":"data";for(var t in e[n])e[n].hasOwnProperty(t)&&null===e[n][t]&&delete e[n][t];return e}));var P=L,R=function(e){return P.get("/api/proto/get_scan_proto",{params:e})},D=function(e){return P.post("/api/scan/completed",e)};t(215);var W=function(e){var n=function(){var e=Object(c.useRef)(!1);return Object(c.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}();return Object(c.useCallback)((function(){return n.current?e.apply(void 0,arguments):void 0}),[n,e])},q=function(){var e=Object(c.useState)(k),n=Object(j.a)(e,2),t=n[0],l=n[1],i=Object(c.useState)(0),s=Object(j.a)(i,2),a=s[0],o=s[1],v=Object(c.useState)(""),b=Object(j.a)(v,2),O=b[0],x=b[1],h=Object(c.useState)([]),m=Object(j.a)(h,2),f=m[0],p=m[1],N=S(),w=N.sendRef,C=N.setFormValue,I=N.formValue,T=W(p),L=Object(c.useRef)({sex:"male"});Object(c.useEffect)((function(){if(console.log(I),I){var e=t.map((function(e){return console.log(I[e.name]),e.defaultValue=I[e.name],e}));console.log(e)}}),[]),Object(c.useEffect)((function(){var e;P.get("/api/scan/get_position_list",{params:e}).then((function(e){T(e.data.data.dataList)}))}),[]);var R=function(e){o(e),f.forEach((function(n){n.id===e&&x(n.name)}))},D=function(e,n,c){var i=n.name,s=n.require,a=n.validator;if(L.current[i]=e,!s||a(e)!==!n.isError){var r=Object.assign([],t);r[c]=Object(u.a)(Object(u.a)({},r[c]),{},{isError:!(s&&a(e))}),l(r),console.log(k)}};return Object(g.jsxs)("div",{className:"choosePart",children:[Object(g.jsx)(y,{"title-lg":"\u78c1\u5171\u632f\u6210\u50cf\u7cfb\u7edf"}),Object(g.jsxs)("div",{className:"formWrap",children:[Object(g.jsx)("h2",{children:"\u586b\u5199\u60a3\u8005\u4fe1\u606f"}),Object(g.jsx)("form",{children:Object(g.jsx)("ul",{children:t.map((function(e,n){return Object(g.jsxs)("li",{children:[Object(g.jsx)("h4",{children:e.label}),"input"===e.type?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("input",{className:e.isError?"err":"",type:"text",defaultValue:e.defaultValue,onChange:function(t){return D(t.target.value,e,n)},placeholder:e.placeholder,maxLength:e.maxLength}),e.isError?Object(g.jsx)("span",{children:e.message}):null]}):Object(g.jsx)(E,{sex:L.current[e.name]||e.defaultValue,index:n,item:e,changeGender:D})]},e.id)}))})})]}),Object(g.jsxs)("div",{className:"partWrap",children:[Object(g.jsxs)("ul",{children:[f.map((function(e){return Object(g.jsxs)("li",{className:a===e.id?"active":"",onClick:R.bind(null,e.id),children:[Object(g.jsx)("img",{src:e.img,alt:""}),Object(g.jsx)("p",{children:e.name_cn})]},e.id)})),Object(g.jsx)("li",{className:"itemEmpty",children:" "}),Object(g.jsx)("li",{className:"itemEmpty",children:" "}),Object(g.jsx)("li",{className:"itemEmpty",children:" "})]}),Object(g.jsx)("button",{onClick:function(){for(var e,n=L.current,c=!1,i=Object.assign([],t),s=0;s<t.length;s++){var a=t[s],o=a.require,j=a.validator,v=a.name;o&&(o&&j(n[v]||t[s].defaultValue)||(c=!0,i[s]=Object(u.a)(Object(u.a)({},i[s]),{},{isError:!0})))}if(c)c&&l(i);else{var b=new FormData;if(!O)return void d.a.fail("\u8bf7\u9009\u62e9\u90e8\u4f4d");b.append("bodyType",O);var x,h=Object(r.a)(t);try{for(h.s();!(x=h.n()).done;){var m=x.value,f=m.name;b.append(f,n[f]||m.defaultValue)}}catch(p){h.e(p)}finally{h.f()}console.log("result",n),C(n),(e=b,P.post("/api/patient/register_patient",e)).then((function(e){var n;200===e.data.code&&(null===(n=w.current)||void 0===n||n.call(w,function(e){var n={action:"confirm",userid:e};return JSON.stringify(n)}(e.data.data.id)))}))}},className:"btn",children:"\u786e\u8ba4"})]})]})},V=(t(216),t(217),function(){var e=S(),n=e.wsDataSource,t=e.sendRef,l=Object(c.useState)([]),i=Object(j.a)(l,2),s=i[0],a=i[1],r=Object(c.useContext)(U),o=r.waitList,u=r.setWaitList;Object(c.useEffect)((function(){(null===n||void 0===n?void 0:n.bodyType)&&R({bodyType:null===n||void 0===n?void 0:n.bodyType}).then((function(e){a(e.data.data.dataList)})).catch((function(e){throw new Error(e)}))}),[null===n||void 0===n?void 0:n.bodyType]);var v=function(e){var c,l=JSON.parse(JSON.stringify(o));if(o.find((function(n){return n.id===e.id})))d.a.fail("\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\u534f\u8bae");else{for(var i=null===n||void 0===n?void 0:n.scanInfo,s=0;s<i.length;s++)if((2===i[s].state||3===i[s].state)&&i[s].id===e.id)return void d.a.fail("\u4e0d\u80fd\u6dfb\u52a0\u6b63\u5728\u626b\u63cf\u7684\u534f\u8bae");"\u5b9a\u4f4d\u626b\u63cf"!==e.name?(l.push(e),u(l),null===(c=t.current)||void 0===c||c.call(t,function(e,n){var t={action:"add",userid:e,xprList:n};return JSON.stringify(t)}(null===n||void 0===n?void 0:n.userid,[e]))):d.a.fail("\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\u5b9a\u4f4d\u626b\u63cf")}};return Object(g.jsx)("div",{className:"ProtocolMenu",children:Object(g.jsx)("ul",{children:null===s||void 0===s?void 0:s.map((function(e,n){return Object(g.jsxs)("li",{children:[Object(g.jsx)("h3",{children:e.name}),Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("span",{children:e.time}),Object(g.jsx)("img",{src:"/plus.png",alt:"",onClick:v.bind(null,e,n)})]})]},e.id)}))})})}),M=t(64),F=(t(219),x.a.alert),J=function(){var e,n=S(),t=n.wsDataSource,l=n.sendRef,i=Object(c.useContext)(U),s=i.waitList,a=i.setWaitList;Object(c.useEffect)((function(){var e=[],n=null===t||void 0===t?void 0:t.scanInfo;if(n){for(var c=0;c<n.length;c++)1===n[c].state&&e.push(n[c]);a(e)}}),[null===t||void 0===t?void 0:t.scanInfo]);var r=function(e){F("\u5220\u9664","\u786e\u8ba4\u5220\u9664".concat(e.name,"\u5417?"),[{text:"\u53d6\u6d88"},{text:"\u5220\u9664",onPress:function(){var n;delete e.chosen,null===(n=l.current)||void 0===n||n.call(l,function(e,n){var t={action:"delete",userid:e,xprList:[n]};return JSON.stringify(t)}(null===t||void 0===t?void 0:t.userid,e))}}])};return Object(g.jsxs)("div",{className:"protocolState",children:[Object(g.jsxs)("div",{className:"headerInfo",children:[Object(g.jsx)("img",{src:"/sound.png",alt:""}),Object(g.jsx)("h2",{children:"\u672c\u6b21\u626b\u63cf\u534f\u8bae\u5217\u8868"}),Object(g.jsxs)("div",{className:"tips",children:[Object(g.jsx)("img",{src:"/exclamation.png",alt:""}),Object(g.jsx)("span",{children:"\u957f\u6309\u534f\u8bae\u53ef\u8c03\u6574\u626b\u63cf\u987a\u5e8f"})]})]}),Object(g.jsx)("div",{className:"protocolWrap",children:Object(g.jsxs)("ul",{children:[null===t||void 0===t||null===(e=t.scanInfo)||void 0===e?void 0:e.map((function(e){switch(e.state){case 5:return Object(g.jsxs)("li",{className:"scaned",children:[Object(g.jsx)("div",{className:"upInfo",children:Object(g.jsx)("span",{children:e.sequenceNo})}),Object(g.jsxs)("div",{className:"downInfo",children:[Object(g.jsx)("h3",{children:e.name}),Object(g.jsx)("div",{className:"processWrap",children:"\u5df2\u5b8c\u6210"})]})]},e.sequenceNo);case 2:case 3:return Object(g.jsxs)("li",{className:"scanning",children:[Object(g.jsx)("div",{className:"upInfo",children:Object(g.jsx)("span",{children:e.sequenceNo})}),Object(g.jsxs)("div",{className:"downInfo",children:[Object(g.jsx)("h3",{children:e.name}),Object(g.jsxs)("div",{className:"processWrap",children:[Object(g.jsx)("div",{className:"number",children:f(e.time,e.currow)}),Object(g.jsx)("div",{className:"process",style:{width:"".concat(e.currow/e.totalrow*100,"%")}})]})]})]},e.sequenceNo)}})),Object(g.jsx)(M.ReactSortable,{list:s,setList:a,onEnd:function(e){console.log(s)},children:null===s||void 0===s?void 0:s.map((function(e,n){return Object(g.jsxs)("li",{className:"unscan",children:[Object(g.jsxs)("div",{className:"upInfo",children:[Object(g.jsx)("span",{children:e.sequenceNo}),Object(g.jsx)("img",{src:"/close.png",alt:"",onClick:r.bind(null,e)})]}),Object(g.jsxs)("div",{className:"downInfo",children:[Object(g.jsx)("h3",{children:e.name}),Object(g.jsx)("div",{className:"processWrap",children:"\u672a\u626b\u63cf"})]})]},n)}))})]})})]})},U=(t(220),Object(c.createContext)(null)),A=function(){var e=Object(c.useState)([]),n=Object(j.a)(e,2),t=n[0],l=n[1],i=Object(c.useState)(0),s=Object(j.a)(i,2),a=s[0],r=s[1],o=Object(c.useState)(null),d=Object(j.a)(o,2),u=d[0],v=d[1];return Object(g.jsx)(U.Provider,{value:{chooseIndex:a,setChooseIndex:r,chooseItem:u,setChooseItem:v,waitList:t,setWaitList:l},children:Object(g.jsxs)("div",{className:"ScanList",children:[Object(g.jsx)(J,{}),Object(g.jsx)(V,{})]})})},B=(t(221),function(){var e,n=S().wsDataSource,t=Object(c.useContext)(ne),l=t.scanImageTab,i=t.setScanImageTab,s=function(e){i(e)};return Object(g.jsx)("ul",{className:"imageMenu",children:null===n||void 0===n||null===(e=n.scanInfo)||void 0===e?void 0:e.map((function(e,n){switch(e.state){case 5:return Object(g.jsxs)("li",{className:n===l?"scaned active":"scaned",onClick:s.bind(null,n),children:[Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("span",{children:e.id}),Object(g.jsx)("h3",{children:e.name})]}),Object(g.jsxs)("div",{className:"state",children:[Object(g.jsx)("h3",{children:"\u5df2\u5b8c\u6210"}),Object(g.jsx)("div",{children:" "})]}),Object(g.jsx)("div",{className:"line",children:" "})]},e.sequenceNo);case 2:case 3:return Object(g.jsxs)("li",{className:n===l?"scanning active":"scanning",onClick:s.bind(null,n),children:[Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("span",{children:e.id}),Object(g.jsx)("h3",{children:e.name})]}),Object(g.jsxs)("div",{className:"state",children:[Object(g.jsx)("h3",{children:f(e.time,e.currow)}),Object(g.jsx)("div",{style:{width:"".concat(e.currow/e.totalrow*100,"%")},children:" "})]}),Object(g.jsx)("div",{className:"line",children:" "})]},e.sequenceNo);case 1:return Object(g.jsxs)("li",{className:n===l?"unscan active":"unscan",onClick:s.bind(null,n),children:[Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("span",{children:e.id}),Object(g.jsx)("h3",{children:e.name})]}),Object(g.jsxs)("div",{className:"state",children:[Object(g.jsx)("h3",{children:e.time}),Object(g.jsx)("div",{children:" "})]}),Object(g.jsx)("div",{className:"line",children:" "})]},e.sequenceNo)}}))})}),_=function(e){var n=e.className,t=e.imgUrl,c=e.txt,l=e.clk;return Object(g.jsxs)("button",{className:n,onClick:l,children:[Object(g.jsx)("img",{src:t,alt:""}),Object(g.jsx)("span",{children:c})]})},G=t(137),z=t.n(G),X=t(138),$=t.n(X),H=t(25),K=t.n(H),Q=function(e){var n=e.url,t=e.no,l=e.clk;return Object(c.useEffect)((function(){K.a.gui.getElement=K.a.gui.base.getElement;var e=new K.a.App;e.init({containerDivId:"dwv"+t}),e.loadURLs([n])}),[n]),Object(g.jsx)("li",{id:"dwv"+t,className:"dcm",onClick:l,children:Object(g.jsx)("div",{className:"layerContainer",children:" "})})};function Y(e){var n=e.dcmArr;return Object(g.jsx)("ul",{className:"imageGroup",id:"dcmWrap",children:null===n||void 0===n?void 0:n.map((function(e,n){return Object(g.jsx)(Q,{url:e,no:n},e)}))})}t(322);var Z=x.a.alert,ee=function(){var e,n,t,l,i,s,a,r,o,d,u=S(),j=u.wsDataSource,v=u.sendRef,b=Object(c.useContext)(ne).scanImageTab;return Object(g.jsxs)("div",{className:"imageState",children:[Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("h3",{children:null===j||void 0===j||null===(e=j.scanInfo)||void 0===e||null===(n=e[b])||void 0===n?void 0:n.name}),2===(null===j||void 0===j||null===(t=j.scanInfo)||void 0===t||null===(l=t[b])||void 0===l?void 0:l.state)?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(_,{className:"restart unused",imgUrl:"/restart2.png",txt:"\u91cd\u65b0\u626b\u63cf\u534f\u8bae"}),Object(g.jsx)(_,{className:"pause",imgUrl:"/pause.png",txt:"\u505c\u6b62\u534f\u8bae",clk:function(){var e,n;Z("\u505c\u6b62\u534f\u8bae","\u786e\u8ba4\u505c\u6b62".concat(null===j||void 0===j||null===(e=j.scanInfo)||void 0===e||null===(n=e[b])||void 0===n?void 0:n.name,"\u5417\uff1f"),[{text:"\u53d6\u6d88"},{text:"\u786e\u8ba4\u505c\u6b62",onPress:function(){var e,n;null===(e=v.current)||void 0===e||e.call(v,function(e,n){var t={action:"suspend",userid:e,xprList:n};return JSON.stringify(t)}(null===j||void 0===j?void 0:j.userid,[null===j||void 0===j||null===(n=j.scanInfo)||void 0===n?void 0:n[b]]))}}])}})]}):null,3===(null===j||void 0===j||null===(i=j.scanInfo)||void 0===i||null===(s=i[b])||void 0===s?void 0:s.state)?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(_,{className:"restart",imgUrl:"/restart.png",txt:"\u91cd\u65b0\u626b\u63cf\u534f\u8bae",clk:function(){var e;null===(e=v.current)||void 0===e||e.call(v,function(e){var n={action:"continue",userid:e};return JSON.stringify(n)}(null===j||void 0===j?void 0:j.userid))}}),Object(g.jsx)(_,{className:"pause unused",imgUrl:"/pause2.png",txt:"\u505c\u6b62\u534f\u8bae"})]}):null]}),Object(g.jsx)("div",{className:"ground",children:5!==(null===j||void 0===j||null===(a=j.scanInfo)||void 0===a||null===(r=a[b])||void 0===r?void 0:r.state)?Object(g.jsx)("img",{src:"/scanning.png",alt:""}):z()($()(j,"scanInfo[".concat(b,"].url"),[]))?Object(g.jsx)("img",{src:"/loading.png",alt:""}):Object(g.jsx)(Y,{dcmArr:null===j||void 0===j||null===(o=j.scanInfo)||void 0===o||null===(d=o[b])||void 0===d?void 0:d.url})})]})},ne=(t(323),Object(c.createContext)(null)),te=function(){var e=Object(c.useState)(0),n=Object(j.a)(e,2),t=n[0],l=n[1];return Object(g.jsx)(ne.Provider,{value:{scanImageTab:t,setScanImageTab:l},children:Object(g.jsxs)("div",{className:"scanImage",children:[Object(g.jsx)(B,{}),Object(g.jsx)(ee,{})]})})},ce=function(){var e=Object(c.useState)("1"),n=Object(j.a)(e,2),t=n[0],l=n[1],i=S().wsDataSource,s=function(e){l(e.target.dataset.tab)};return Object(g.jsxs)("div",{className:"scanCheck",children:[Object(g.jsx)(y,{uid:null===i||void 0===i?void 0:i.userid,timer:!0,loading:function(){for(var e=null===i||void 0===i?void 0:i.scanInfo,n=0,t=0,c=0;c<(null===e||void 0===e?void 0:e.length);c++)n+=h(e[c].time),5===e[c].state?t+=h(e[c].time):2!==e[c].state&&3!==e[c].state||(t+=h(e[c].time)*(e[c].currow/e[c].totalrow));return t/n*100}(),close:!0,timerTitle:"\u5269\u4f59\u603b\u65f6\u957f",timerNum:function(){for(var e=null===i||void 0===i?void 0:i.scanInfo,n=0,t=0;t<(null===e||void 0===e?void 0:e.length);t++)5!==e[t].state&&(1===e[t].state?n+=h(e[t].time):n+=h(e[t].time)*(100-e[t].currow)/100);return m(n)}(),children:Object(g.jsxs)("ul",{className:"tabs",children:[Object(g.jsxs)("li",{className:"1"===t?"active":"",onClick:s,"data-tab":"1",children:["\u534f\u8bae\u5217\u8868",Object(g.jsx)("b",{children:" "})]}),Object(g.jsxs)("li",{className:"2"===t?"active":"",onClick:s,"data-tab":"2",children:["\u626b\u67e5\u5f71\u50cf",Object(g.jsx)("b",{children:" "})]})]})}),Object(g.jsx)("div",{className:"content",children:"1"===t?Object(g.jsx)(A,{}):Object(g.jsx)(te,{})})]})},le=t(93),ie=(t(324),function(){var e=S(),n=e.wsDataSource,t=e.setRouterPath,l=e.sendRef,i=Object(c.useState)([]),s=Object(j.a)(i,2),a=s[0],r=s[1],o=Object(c.useState)([]),u=Object(j.a)(o,2),v=u[0],b=u[1],O=Object(c.useState)({}),x=Object(j.a)(O,2),f=x[0],p=x[1],N=Object(c.useState)(0),w=Object(j.a)(N,2),C=w[0],I=w[1],E=W(r),k=W(b),T=W(p);Object(c.useEffect)((function(){(null===n||void 0===n?void 0:n.bodyType)&&R({bodyType:null===n||void 0===n?void 0:n.bodyType}).then((function(e){for(var n=e.data.data.dataList,t=[],c=[],l=0;l<n.length;l++)"\u5b9a\u4f4d\u626b\u63cf"===n[l].name?(T(n[l]),I(C+h(n[l].time))):"buildin"===n[l].protoType?t.push(n[l]):c.push(n[l]);k(t),E(c)}))}),[n]);var L=function(e){console.log(e);for(var n=Object(le.a)(v),t=0;t<n.length;t++)if(n[t].id===e.id)return void d.a.fail("\u5df2\u6dfb\u52a0\u8be5\u9879");e.currow=0,n.push(e),k(n),I(C+h(e.time))},P=function(e,n){console.log(e);var t=Object(le.a)(v);t.splice(n,1),k(t),I(C-h(e.time))};return Object(g.jsxs)("div",{className:"protocolList",children:[Object(g.jsx)(y,{"title-lg":null===n||void 0===n?void 0:n.bodyTypeCn,timer:!0,timerTitle:"\u5269\u4f59\u603b\u65f6\u957f",timerNum:m(C)}),Object(g.jsxs)("div",{className:"listContent",children:[Object(g.jsxs)("div",{className:"lPart",children:[Object(g.jsxs)("div",{className:"up",children:[Object(g.jsxs)("div",{className:"topInfo",children:[Object(g.jsxs)("div",{className:"l",children:[Object(g.jsx)("img",{src:"/sound.png",alt:""}),Object(g.jsx)("h3",{children:"\u672c\u6b21\u626b\u63cf\u534f\u8bae\u5217\u8868"})]}),Object(g.jsxs)("div",{className:"r",children:[Object(g.jsx)("img",{src:"/exclamation.png",alt:""}),Object(g.jsx)("h4",{children:"\u957f\u6309\u534f\u8bae\u53ef\u8c03\u6574\u626b\u63cf\u987a\u5e8f"})]})]}),Object(g.jsxs)("ul",{className:"protocolBlocks",children:[Object(g.jsxs)("li",{children:[Object(g.jsx)("div",{className:"upInfo",children:Object(g.jsx)("div",{className:"sort",children:"1"})}),Object(g.jsxs)("div",{className:"content",children:[Object(g.jsx)("h4",{children:f.name}),Object(g.jsx)("div",{className:"timer",children:f.time})]})]}),Object(g.jsx)(M.ReactSortable,{list:v,setList:k,dragClass:"chosen-class",ghostClass:"chosen-class",chosenClass:"chosen-class",children:v.map((function(e,n){return Object(g.jsxs)("li",{children:[Object(g.jsxs)("div",{className:"upInfo",children:[Object(g.jsx)("div",{className:"sort",children:n+2}),"buildin"===e.protoType?null:Object(g.jsx)("img",{src:"/close.png",alt:"",className:"close",onClick:P.bind(null,e,n)})]}),Object(g.jsxs)("div",{className:"content",children:[Object(g.jsx)("h4",{children:e.name}),Object(g.jsx)("div",{className:"timer",children:e.time})]})]},e.id)}))})]})]}),Object(g.jsxs)("div",{className:"down",children:[Object(g.jsx)("button",{className:"lBtn",onClick:function(){var e,c=v;c.unshift(f),0!==c.length?(null===(e=l.current)||void 0===e||e.call(l,function(e,n){var t={action:"scan",userid:e,xprList:n};return JSON.stringify(t)}(null===n||void 0===n?void 0:n.userid,c)),t("Scanning")):d.a.fail("\u672a\u9009\u62e9\u4efb\u4f55\u534f\u8bae")},children:"\u5f00\u59cb\u68c0\u67e5"}),Object(g.jsx)("button",{className:"rBtn",onClick:function(){for(var e=v,n=C,t=0;t<e.length;t++)n-=h(e[t].time);I(n),k([])},children:"\u6062\u590d\u9ed8\u8ba4\u534f\u8bae"})]})]}),Object(g.jsx)("div",{className:"rPart",children:Object(g.jsx)("ul",{children:a.map((function(e){return Object(g.jsxs)("li",{children:[Object(g.jsx)("div",{className:"name",children:e.name}),Object(g.jsx)("img",{src:"/plus.png",alt:"",className:"plus",onClick:L.bind(null,e)}),Object(g.jsx)("div",{className:"time",children:e.time})]},e.id)}))})})]})]})}),se=function(){return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{id:"tags",children:" "})})},ae=(t(325),function(){var e=S().wsDataSource,n=Object(c.useContext)(ue),t=n.tabIndex,l=n.setTabIndex,i=function(e){l(e)};return Object(g.jsx)("ul",{className:"protocolMenu",children:null===e||void 0===e?void 0:e.scanInfo.map((function(e,n){return Object(g.jsxs)("li",{className:t===n?"active":"",onClick:i.bind(null,n),children:[Object(g.jsx)("span",{children:e.sequenceNo}),Object(g.jsx)("h3",{children:e.name}),Object(g.jsx)("div",{className:"line",children:" "})]},e.sequenceNo)}))})}),re=(t(326),t(327),function(e){var n=e.setTip;return Object(g.jsxs)("div",{className:"tip",children:[Object(g.jsx)("h1",{children:"\u6ed1\u52a8\u8c03\u8282\u7a97\u5bbd\u7a97\u4f4d"}),Object(g.jsx)("img",{src:"/swipe.png",alt:""}),Object(g.jsx)("button",{onClick:function(){n(!1)},children:"\u6211\u77e5\u9053\u4e86"})]})}),oe=function(e){var n,t,l,i,s,a,r,o,d,u,v,b,O,x,h,m,f,p,N,w,S,C,y,I,E,k,T,L,R,D,W,q,V=e.url,M=e.dcmShow,F=e.setDcmShow,J=e.changeDcm,U=Object(c.useState)(null),A=Object(j.a)(U,2),B=A[0],_=A[1],G=Object(c.useState)(!1),z=Object(j.a)(G,2),X=z[0],$=z[1];Object(c.useEffect)((function(){Q(),H(V),function(e){return P.get(e,{responseType:"arraybuffer"})}(V).then((function(e){var n=new K.a.dicom.DicomParser;n.parse(e.data);var t=n.getRawDicomElements();_(t)})),Z()}),[V]);var H=function(e){K.a.gui.getElement=K.a.gui.base.getElement;var n=new K.a.App;n.init({containerDivId:"dwv",tools:{WindowLevel:{}}}),n.addEventListener("load",(function(){n.setTool("WindowLevel")})),n.loadURLs([e])},Q=function(){var e=document.getElementById("parentNode");if(e)for(;e.firstChild;)e.removeChild(e.firstChild)},Y=function(e,n){n.stopPropagation(),J(e)},Z=function(){localStorage.getItem("tip")||($(!0),localStorage.setItem("tip","true"))};return Object(g.jsxs)(g.Fragment,{children:[M?Object(g.jsxs)("div",{className:"dcmDetail",onClick:function(){F(!1)},children:[Object(g.jsxs)("div",{className:"detail",children:[Object(g.jsxs)("div",{className:"tl info",children:[Object(g.jsxs)("p",{children:[(null===B||void 0===B||null===(n=B.x00100010)||void 0===n?void 0:n.value[0])?null===B||void 0===B||null===(t=B.x00100010)||void 0===t?void 0:t.value[0]:"",", ",(null===B||void 0===B||null===(l=B.x00100040)||void 0===l?void 0:l.value[0])?null===B||void 0===B||null===(i=B.x00100040)||void 0===i?void 0:i.value[0]:""]}),Object(g.jsxs)("p",{children:[(null===B||void 0===B||null===(s=B.x0008103E)||void 0===s?void 0:s.value[0])?null===B||void 0===B||null===(a=B.x0008103E)||void 0===a?void 0:a.value[0]:"",", ",(null===B||void 0===B||null===(r=B.x00080021)||void 0===r?void 0:r.value[0])?null===B||void 0===B||null===(o=B.x00080021)||void 0===o?void 0:o.value[0]:""]}),Object(g.jsxs)("p",{children:[(null===B||void 0===B||null===(d=B.x00281050)||void 0===d?void 0:d.value[0])?"WL: ".concat(null===B||void 0===B||null===(u=B.x00281050)||void 0===u?void 0:u.value[0]):"",(null===B||void 0===B||null===(v=B.x00281051)||void 0===v?void 0:v.value[0])?", WW: ".concat(null===B||void 0===B||null===(b=B.x00281051)||void 0===b?void 0:b.value[0]):""]})]}),Object(g.jsxs)("div",{className:"tr info",children:[Object(g.jsx)("p",{children:(null===B||void 0===B||null===(O=B.x00080070)||void 0===O?void 0:O.value[0])?null===B||void 0===B||null===(x=B.x00080070)||void 0===x?void 0:x.value[0]:""}),Object(g.jsx)("p",{children:(null===B||void 0===B||null===(h=B.x00080060)||void 0===h?void 0:h.value[0])?null===B||void 0===B||null===(m=B.x00080060)||void 0===m?void 0:m.value[0]:""})]}),Object(g.jsxs)("div",{className:"bl info",children:[Object(g.jsx)("p",{children:(null===B||void 0===B||null===(f=B.x00181030)||void 0===f?void 0:f.value[0])?null===B||void 0===B||null===(p=B.x00181030)||void 0===p?void 0:p.value[0]:""}),Object(g.jsx)("p",{children:(null===B||void 0===B||null===(N=B.x00180080)||void 0===N?void 0:N.value[0])?"TR: ".concat(null===B||void 0===B||null===(w=B.x00180080)||void 0===w?void 0:w.value[0]," ms"):""}),Object(g.jsx)("p",{children:(null===B||void 0===B||null===(S=B.x00180081)||void 0===S?void 0:S.value[0])?"TE: ".concat(null===B||void 0===B||null===(C=B.x00180081)||void 0===C?void 0:C.value[0]," ms"):""}),Object(g.jsx)("p",{children:(null===B||void 0===B||null===(y=B.x00180087)||void 0===y?void 0:y.value[0])?"Field: ".concat(null===B||void 0===B||null===(I=B.x00180087)||void 0===I?void 0:I.value[0]," T"):""}),Object(g.jsx)("p",{children:(null===B||void 0===B||null===(E=B.x00181314)||void 0===E?void 0:E.value[0])?"Flip Angle: ".concat(null===B||void 0===B||null===(k=B.x00181314)||void 0===k?void 0:k.value[0],"\xb0"):""})]}),Object(g.jsxs)("div",{className:"br info",children:[Object(g.jsx)("p",{children:(null===B||void 0===B||null===(T=B.x00180050)||void 0===T?void 0:T.value[0])?"Slice Thk: ".concat(null===B||void 0===B||null===(L=B.x00180050)||void 0===L?void 0:L.value[0]," mm"):""}),Object(g.jsxs)("p",{children:[(null===B||void 0===B||null===(R=B.x00280010)||void 0===R?void 0:R.value[0])?"Res: ".concat(null===B||void 0===B||null===(D=B.x00280010)||void 0===D?void 0:D.value[0]," "):"",(null===B||void 0===B||null===(W=B.x00280011)||void 0===W?void 0:W.value[0])?"X ".concat(null===B||void 0===B||null===(q=B.x00280011)||void 0===q?void 0:q.value[0]):""]})]}),Object(g.jsx)("div",{id:"dwv",className:"dcm",children:Object(g.jsx)("div",{className:"layerContainer",id:"parentNode",children:" "})})]}),Object(g.jsx)("img",{src:"/left.png",alt:"",className:"prev",onClick:Y.bind(null,"prev")}),Object(g.jsx)("img",{src:"/right.png",alt:"",className:"next",onClick:Y.bind(null,"next")})]}):null,X?Object(g.jsx)(re,{setTip:$}):null]})},de=(t(328),function(){var e,n,t,l=S(),i=l.wsDataSource,s=l.setFormValue,a=l.setRouterPath,r=Object(c.useContext)(ue).tabIndex,o=Object(c.useState)(!1),u=Object(j.a)(o,2),v=u[0],b=u[1],O=Object(c.useState)(""),x=Object(j.a)(O,2),h=x[0],m=x[1],f=Object(c.useState)(""),p=Object(j.a)(f,2),N=p[0],w=p[1],C=Object(c.useState)(0),y=Object(j.a)(C,2),I=y[0],E=y[1];Object(c.useEffect)((function(){var e,n;E(null===i||void 0===i||null===(e=i.scanInfo)||void 0===e||null===(n=e[r])||void 0===n?void 0:n.url.length)}),[r]);var k=function(e,n){b(!0),w(n),m(e)};return Object(g.jsxs)("div",{className:"protocolSpace",children:[Object(g.jsxs)("div",{className:"title",children:[Object(g.jsx)("h2",{children:null===i||void 0===i||null===(e=i.scanInfo)||void 0===e?void 0:e[r].name}),Object(g.jsxs)("button",{children:[Object(g.jsx)("img",{src:"/exclamation.png",alt:""}),Object(g.jsx)("span",{children:"\u70b9\u51fb\u67e5\u770b\u5927\u56fe"})]})]}),Object(g.jsx)("div",{className:"space",children:Object(g.jsx)("ul",{children:null===i||void 0===i||null===(n=i.scanInfo)||void 0===n||null===(t=n[r])||void 0===t?void 0:t.url.map((function(e,n){return Object(g.jsx)(Q,{url:e,no:n,clk:k.bind(null,e,n)},e)}))})}),Object(g.jsxs)("div",{className:"handle",children:[Object(g.jsx)("button",{className:"next",onClick:function(){D().then((function(e){console.log(e)})).catch((function(e){throw new Error(e)})),s(null),a("Prepare")},children:"\u68c0\u67e5\u4e0b\u4e00\u4e2a\u60a3\u8005"}),Object(g.jsx)("button",{className:"present",onClick:function(){D().then((function(e){console.log(e)})).catch((function(e){throw new Error(e)})),a("Prepare")},children:"\u7ee7\u7eed\u68c0\u67e5\u5f53\u524d\u60a3\u8005"})]}),v?Object(g.jsx)(oe,{url:h,dcmShow:v,setDcmShow:b,changeDcm:function(e){var n,t,c;if("prev"===e)N-1>-1?(w(N-1),m(null===i||void 0===i||null===(n=i.scanInfo)||void 0===n||null===(t=n[r])||void 0===t||null===(c=t.url)||void 0===c?void 0:c[N-1])):d.a.success("\u5df2\u7ecf\u662f\u7b2c\u4e00\u5f20\u4e86",1.2);else if("next"===e){var l,s,a;if(N+1<I)w(N+1),m(null===i||void 0===i||null===(l=i.scanInfo)||void 0===l||null===(s=l[r])||void 0===s||null===(a=s.url)||void 0===a?void 0:a[N+1]);else d.a.success("\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u5f20\u4e86",1.2)}}}):null]})}),ue=(t(329),Object(c.createContext)(null)),je=function(){var e=S().wsDataSource,n=Object(c.useState)(0),t=Object(j.a)(n,2),l=t[0],i=t[1];return Object(g.jsx)(ue.Provider,{value:{tabIndex:l,setTabIndex:i},children:Object(g.jsxs)("div",{className:"completed",children:[Object(g.jsx)(y,{"title-lg":null===e||void 0===e?void 0:e.bodyTypeCn}),Object(g.jsxs)("div",{className:"content",children:[Object(g.jsx)(ae,{}),Object(g.jsx)(de,{})]})]})})};function ve(){var e=Object(a.f)(),n=S().routerPath;return Object(c.useEffect)((function(){e.push("/".concat(n))}),[n,e]),Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)(a.c,{children:[Object(g.jsx)(a.a,{path:"/Scanning",children:Object(g.jsx)(ce,{})}),Object(g.jsx)(a.a,{path:"/Prepare",children:Object(g.jsx)(q,{})}),Object(g.jsx)(a.a,{path:"/Plan",children:Object(g.jsx)(ie,{})}),Object(g.jsx)(a.a,{path:"/Completed",children:Object(g.jsx)(je,{})}),Object(g.jsx)(a.a,{path:"/Test",children:Object(g.jsx)(se,{})})]})})}var be=function(){return Object(g.jsx)(w,{children:Object(g.jsx)(ve,{})})},Oe=(t(330),t(45));s.a.render(Object(g.jsx)(Oe.a,{children:Object(g.jsx)(l.a.StrictMode,{children:Object(g.jsx)(be,{})})}),document.getElementById("root"))}},[[331,1,2]]]);
//# sourceMappingURL=main.38aa4dec.chunk.js.map