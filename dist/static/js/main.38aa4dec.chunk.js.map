{"version":3,"sources":["common/utils/index.js","common/constant/index.js","common/encapsulation/context.jsx","common/components/m-header/index.jsx","pages/Prepare/components/gender.jsx","pages/Prepare/formConfig.js","common/http/index.js","common/api/control.js","common/hooks/index.js","pages/Prepare/index.jsx","pages/Scanning/components/protocolMenu/index.jsx","pages/Scanning/components/protocolState/index.jsx","pages/Scanning/components/scanList/index.jsx","pages/Scanning/components/imageMenu/index.jsx","pages/Scanning/components/btn.jsx","pages/Scanning/components/analysis.js","pages/Scanning/components/scanDcm.jsx","pages/Scanning/components/imageState/index.jsx","pages/Scanning/components/scanImage/index.jsx","pages/Scanning/index.jsx","pages/Plan/index.jsx","pages/test/index.jsx","pages/Completed/components/protocolMenu/index.jsx","pages/Completed/components/tip/index.jsx","pages/Completed/components/dcmDetail/index.jsx","pages/Completed/components/protocolSpace/index.jsx","pages/Completed/index.jsx","App.jsx","index.jsx"],"names":["handleTimeStr","str","arr","split","parseInt","handleTimeNum","num","min","Math","floor","handleSingleRest","percent","wsUrl","EncapsulationContext","createContext","displayName","Context","children","useState","wsDataSource","setWsData","routerPath","setRouterPath","formValue","setFormValue","result","setResult","sendRef","useRef","useEffect","ws","WebSocket","onopen","msg","current","send","bind","this","onclose","e","console","log","onerror","onmessage","JSON","parse","data","code","prev","state","Provider","value","useWsContext","context","useContext","Error","alert","MHeader","props","history","useHistory","className","onClick","goBack","type","size","color","text","style","onPress","userId","obj","stringify","stopScan","uid","src","alt","width","genderMap","name","id","img","GenderJsx","index","citem","item","sex","changeGender","changeSex","currentTarget","dataset","map","data-sex","config","isError","label","placeholder","maxLength","require","defaultValue","message","validator","length","test","isNaN","axiosWrap","axios","create","baseURL","timeout","headers","interceptors","request","use","method","toLowerCase","key","hasOwnProperty","get_scan_proto","params","get","completed","post","useSafeImplement","dispatch","mountedRef","isMounted","useMountedRef","useCallback","Prepare","formConfig","setFormConfig","partNum","setPartNum","partName","setPartName","partArr","setPartArrPre","setPartArr","formRef","copy","then","res","dataList","choosePart","selectNum","forEach","el","onChange","getFormConfig","Object","assign","title-lg","target","name_cn","i","formData","FormData","fail","append","confirmInfo","ProtocolMenu","list","setList","protocolContext","waitList","setWaitList","bodyType","catch","err","addItem","find","val","aimArr","scanInfo","push","chooseArr","addProtocol","userid","time","ProtocolState","wsArr","del","chosen","chooseItem","delProtocol","sequenceNo","currow","totalrow","onEnd","ScanList","chooseIndex","setChooseIndex","setChooseItem","ImageMenu","scanImageContext","scanImageTab","setScanImageTab","chooseTab","Btn","imgUrl","txt","clk","Analysis","url","no","dwv","gui","getElement","base","app","App","init","containerDivId","loadURLs","ScanDcm","dcmArr","ImageState","protocolList","pauseScan","continueScan","isEmpty","ScanImage","ScanCheck","tabIndex","setTabIndex","changeTab","tab","timer","loading","all","process","calProcess","close","timerTitle","timerNum","restTime","calRest","data-tab","ProtocolList","setProtocolListPre","protocolBlockState","setProtocolBlockStatePre","fix","setFixPre","setTime","setProtocolList","setProtocolBlockState","setFix","lArr","rArr","protoType","delItem","splice","bodyTypeCn","dragClass","ghostClass","chosenClass","unshift","beginScan","timeResult","Test","completedContext","handleClk","Tip","setTip","DcmDetail","dcmShow","setDcmShow","changeDcm","info","setInfo","tip","analysis","responseType","get_tag","event","dicomParser","dicom","DicomParser","rawTags","getRawDicomElements","checkTip","tools","WindowLevel","addEventListener","setTool","element","document","getElementById","firstChild","removeChild","switchDcm","stopPropagation","localStorage","getItem","setItem","ProtocolSpace","setUrl","urlIndex","setUrlIndex","setMaxLength","handleDcm","success","Completed","Wrap","path","Plan","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.38aa4dec.chunk.js","sourcesContent":["// scan: 开始扫描\nexport const beginScan = (userId, protocolList) => {\n  let obj = {\n    \"action\": \"scan\",\n    \"userid\": userId,\n    \"xprList\": protocolList\n  }\n  return JSON.stringify(obj);\n};\n\n// stop: 终止扫描\nexport const stopScan = (userId) => {\n  let obj = {\n    \"action\": \"stop\",\n    \"userid\": userId\n  };\n  return JSON.stringify(obj);\n};\n\n// pause: 暂停扫描\nexport const pauseScan = (userId, protocolList) => {\n  let obj = {\n    \"action\": \"suspend\",\n    \"userid\": userId,\n    \"xprList\": protocolList\n  };\n  return JSON.stringify(obj);\n};\n\n// continue: 继续 重新开始扫描\nexport const continueScan = (userId) => {\n  let obj = {\n    \"action\": \"continue\",\n    \"userid\": userId\n  };\n  return JSON.stringify(obj);\n}\n\n// confirm\nexport const confirmInfo = userId => {\n  let obj = {\n    \"action\": \"confirm\",\n    \"userid\": userId\n  };\n  return JSON.stringify(obj);\n}\n\n// 添加协议\nexport const addProtocol = (userId, chooseArr) => {\n  let obj = {\n    \"action\": \"add\",\n    \"userid\": userId,\n    \"xprList\": chooseArr\n  };\n  return JSON.stringify(obj);\n};\n\n// 删除协议\nexport const delProtocol = (userId, chooseItem) => {\n  let obj = {\n    \"action\": \"delete\",\n    \"userid\": userId,\n    \"xprList\": [chooseItem]\n  };\n  return JSON.stringify(obj);\n}\n\n\nexport const handleTimeStr = str => {\n  if (!str) {\n    return;\n  }\n  let arr = str.split(\":\")\n  return parseInt(arr[0]) * 60 + parseInt(arr[1])\n}\n\nexport const handleTimeNum = num => {\n  let min = Math.floor(num % 3600);\n  let h = Math.floor(num / 3600) > 0 ? Math.floor(num / 3600) + \":\" : \"\";\n  let m = Math.floor(min / 60) > 9 ? Math.floor(min / 60) + \":\" : \"0\" + Math.floor(min / 60) + \":\";\n  let s = Math.floor(num % 60 > 9 ? num % 60 : \"0\" + num % 60) > 9 ? Math.floor(num % 60 > 9 ? num % 60 : \"0\" + num % 60) : \"0\" + Math.floor(num % 60 > 9 ? num % 60 : \"0\" + num % 60);\n  let result\n  result = h + m + s;\n  return result\n}\n\n// 单个协议剩余时间\nexport const handleSingleRest = (str, percent) => {\n  return handleTimeNum(Math.floor((handleTimeStr(str) * (100 - percent)) / 100))\n}\n\n\n","export const wsUrl = \"ws://192.168.101.163:8000/api/ws/scan\";","import {createContext, useContext, useEffect, useRef, useState} from \"react\";\nimport {wsUrl} from \"../constant\";\n\nconst EncapsulationContext = createContext(null);\nEncapsulationContext.displayName = 'wsContent';\n\nconst Context = ({ children }) => {\n  const [wsDataSource, setWsData] = useState(null);\n  const [routerPath, setRouterPath] = useState(null);\n  const [formValue, setFormValue] = useState(null);\n  const [result, setResult] = useState([]);\n  // const [sendMsg, setSendMsg] = useState(null);\n  const sendRef = useRef(null);\n\n  useEffect(() => {\n    let ws = new WebSocket(wsUrl);\n    ws.onopen = function (msg){\n      sendRef.current = ws.send.bind(this);\n    }\n    // a = wsRef.current.onopen\n    ws.onclose = (e) => {\n      console.log(e)\n      ws = new WebSocket(wsUrl);\n    }\n    ws.onerror = () => {\n      console.log(\"error\")\n    }\n    ws.onmessage = (e) => {\n      const result = JSON.parse(e.data);\n      if(result.code === 200) {\n        setWsData(result.data);\n        setRouterPath((prev) => {\n          return result.data?.state || prev\n        });\n      }\n    }\n  },[])\n\n  return (\n    <EncapsulationContext.Provider value={{\n      wsDataSource,\n      routerPath,\n      setRouterPath,\n      formValue,\n      setFormValue,\n      sendRef,\n      result,\n      setResult\n    }}>\n      {\n        children\n      }\n    </EncapsulationContext.Provider>\n  )\n}\n\nexport default Context;\n\nexport function useWsContext() {\n  const context = useContext(EncapsulationContext);\n  if(!context) {\n    throw new Error(\"useWsContext必须在EncapsulationContext中使用\")\n  }\n  return context;\n}","import {useHistory} from \"react-router-dom\";\nimport {Icon, Modal} from 'antd-mobile';\nimport {stopScan} from \"../../utils\";\nimport {useWsContext} from \"../../encapsulation/context\";\nimport \"./style.scss\"\n\nconst alert = Modal.alert;\n\nconst MHeader = (props) => {\n  let history = useHistory();\n  const {sendRef, setFormValue, setRouterPath} = useWsContext();\n  const goPrev = () => {\n    history.goBack();\n  }\n  const stopScanFunc = () => {\n    alert('停止扫描', '协议尚未完成扫描，此时扫描关闭将会丢失本次扫描数据', [\n      {text: '取消', style: 'default'},\n      {\n        text: '关闭扫描',\n        onPress: () => {\n          sendRef.current?.(stopScan(props.uid));\n          // setFormValue(null);\n          setRouterPath('Prepare');\n        }\n      },\n    ]);\n\n  }\n  return (\n    <>\n      <div className=\"warp\">\n        {props[\"prev\"] ?\n          <div className=\"prev\" onClick={goPrev}><Icon type=\"left\" className=\"icon\" size=\"sm\" color=\"#fff\"/>\n          </div> : null}\n        {props[\"title-lg\"] ? <div className=\"title-lg\">{props[\"title-lg\"]}</div> : null}\n        {props[\"title-sm\"] ? <div className=\"title-sm\">{props[\"title-sm\"]}</div> : null}\n        {props[\"close\"] ?\n          <div className=\"close\" onClick={stopScanFunc}>\n            <img src=\"/off.png\" alt=\"\"/>\n            <span>关闭扫描</span>\n          </div>\n          : null\n        }\n        {props[\"loading\"] ?\n          <div className=\"loadingWrap\">\n            <div className=\"loading\" style={{width: props[\"loading\"] + \"%\"}}></div>\n          </div>\n          : null\n        }\n        {props[\"timer\"] ?\n          <div className=\"timerWrap\">\n            <span>{props[\"timerTitle\"]} </span>\n            <b>{props[\"timerNum\"]}</b>\n          </div>\n          : null\n        }\n        {props.children}\n      </div>\n    </>\n  )\n}\n\nexport default MHeader","const genderMap =[\n    {\n      name: '男',\n      id: 'male',\n      img: \"/male\"\n    },\n{\n  name: '女',\n    id: 'female',\n  img: \"/female\"\n}\n]\nconst GenderJsx = ({index, item:citem, sex, changeGender}) => {\n  const changeSex = (e) => {\n    changeGender(e.currentTarget.dataset.sex, citem, index)\n  }\n\n\n  return (\n    <ul>\n      {\n        genderMap.map(item => (\n          <li\n            key={item.id}\n            onClick={changeSex}\n            data-sex={item.id}\n          >\n            <img src={item.img + (sex === 'male' ? 1 : 2) + \".png\"} alt={item.name}/>\n            <span>{item.name}</span>\n          </li>\n        ))\n      }\n    </ul>\n\n  )\n}\n\nexport default GenderJsx;","const config = [\n  {\n    isError: false,\n    id: 1,\n    type: \"input\",\n    label: \"姓名\",\n    name: \"name\",\n    placeholder: \"请输入姓名\",\n    maxLength: 15,\n    require: true,\n    defaultValue: '',\n    message: '请输入5字以内的姓名',\n    validator: (value = '') => value.length > 0,\n  },\n  {\n    isError: false,\n    id: 2,\n    type: \"input\",\n    label: \"手机号\",\n    name: \"phonenum\",\n    placeholder: \"请输入正确的手机号\",\n    maxLength: 11,\n    require: true,\n    defaultValue: '',\n    message: '请输入手机号',\n    validator: (value = '') => /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/.test(value),\n  },\n  {\n    isError: false,\n    id: 3,\n    type: \"input\",\n    name: \"age\",\n    label: \"年龄\",\n    maxLength: 3,\n    placeholder: \"请输入年龄(6-120岁)\",\n    require: true,\n    defaultValue: '',\n    message: '请输入6-120的数字',\n    validator: (value='') => !isNaN(value) && value > 5 && value < 121,\n  },\n  {\n    isError: false,\n    id: 4,\n    type: \"input\",\n    name: \"weight\",\n    label: \"体重\",\n    maxLength: 3,\n    placeholder: \"请输入体重(单位:公斤)\",\n    require: true,\n    defaultValue: '',\n    message: '请输入1-100的数字',\n    validator: (value='') => !isNaN(value) && value > 0 && value < 101,\n  },\n  {\n    isError: false,\n    id: 5,\n    type: \"slot\",\n    name: \"sex\",\n    label: \"性别\",\n    defaultValue: 'male',\n  },\n];\n\nexport default config;\n","import axios from \"axios\";\nimport { Toast } from 'antd-mobile';\nconst axiosWrap = axios.create({\n  baseURL: '',\n  timeout: 60000,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n})\n\naxiosWrap.interceptors.request.use(function (config){\n  const type = config.method;\n  const name = type.toLowerCase() === 'get' ? 'params' : 'data';\n\n  for(let key in config[name]) {\n    if(config[name].hasOwnProperty(key)) {\n      if(config[name][key] === null) {\n        delete config[name][key]\n      }\n    }\n  }\n  return config\n\n})\n\n// axiosWrap.interceptors.response.use((response) => {\n//   // if (Reflect.has(response.data, 'code')) {\n//   //   // if(response.data.code !== 200) {\n//   //   //   for(const key in response.data.data) {\n//   //   //     if(response.data.data.hasOwnProperty(key)) {\n//   //   //       Toast.fail(response.data.data[key]);\n//   //   //     }\n//   //   //   }\n//   //   //   return Promise.reject()\n//   //   // }\n//   //   return response;\n//   // }\n// });\nexport default axiosWrap\n","import axiosWrap from \"../http\";\n// import {paramsList} from \"swiper/angular/angular/src/utils/params-list\";\n\n// 患者信息设定\nexport const register_patient = data => {\n  return axiosWrap.post(\"/api/patient/register_patient\", data)\n}\n\n// 获取部位信息\nexport const get_position_list = params => {\n  return axiosWrap.get(\"/api/scan/get_position_list\", {\n    params\n  })\n}\n\n// 获取扫描协议\nexport const get_scan_proto = params => {\n  return axiosWrap.get(\"/api/proto/get_scan_proto\", {\n    params\n  })\n}\n\n// 扫描完成（继续当前/扫描下一个）\nexport const completed = params => {\n  return axiosWrap.post(\"/api/scan/completed\", params)\n}\n\n// 获取tag\nexport const get_tag = (url) => {\n  return axiosWrap.get(url, {\n    responseType: 'arraybuffer'\n  })\n}\n","import {\n  useLocation\n} from \"react-router-dom\";\nimport { useRef, useEffect, useCallback } from \"react\";\n\nexport function useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\n\nexport const useMountedRef = () => {\n  const isMounted = useRef(false);\n  useEffect(() => {\n    isMounted.current = true;\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  return isMounted;\n};\n\nexport const useSafeImplement = (dispatch) => {\n  const mountedRef = useMountedRef();\n  return useCallback(\n    (...args) => (mountedRef.current ? dispatch(...args) : void 0),\n    [mountedRef, dispatch]\n  );\n};","import { useEffect, useRef, useState} from \"react\";\nimport {Toast} from \"antd-mobile\";\nimport MHeader from \"../../common/components/m-header\";\nimport GenderJsx from \"./components/gender\";\nimport config from \"./formConfig\";\nimport {get_position_list, register_patient} from \"../../common/api/control\";\nimport \"./style.scss\";\nimport { useSafeImplement} from '../../common/hooks';\nimport {useWsContext} from \"../../common/encapsulation/context\";\nimport {confirmInfo} from \"../../common/utils\";\nconst Prepare = () => {\n  const [formConfig, setFormConfig] = useState(config);\n  const [partNum, setPartNum] = useState(0);\n  const [partName, setPartName] = useState(\"\");\n  const [partArr, setPartArrPre] = useState([]);\n  const {sendRef, setFormValue, formValue} = useWsContext();\n\n  const setPartArr = useSafeImplement(setPartArrPre)\n  const formRef = useRef({sex: \"male\"})\n\n  useEffect(() => {\n    console.log(formValue);\n    if(formValue) {\n      let copy = formConfig.map(item => {\n        console.log(formValue[item.name])\n        item.defaultValue = formValue[item.name]\n        return item\n      })\n      console.log(copy)\n    }\n  },[])\n\n  useEffect(() => {\n    get_position_list().then(res => {\n      setPartArr(res.data.data.dataList)\n    })\n  }, [])\n\n  const choosePart = selectNum => {\n    setPartNum(selectNum)\n    partArr.forEach(el => {\n      if (el.id === selectNum) {\n        setPartName(el.name);\n      }\n    })\n  }\n\n  const onChange = (value, item, index) => {\n    const {name, require, validator} = item;\n    formRef.current[name] = value;\n    if (require && validator(value) === !item.isError) {\n      return;\n    }\n    const getFormConfig = Object.assign([], formConfig)\n\n    getFormConfig[index] = {\n      ...getFormConfig[index],\n      isError: !(require && validator(value)),\n    }\n    setFormConfig(getFormConfig)\n    console.log(config)\n  }\n\n  const submit = () => {\n    const result = formRef.current;\n    let isError = false\n    const getFormConfig = Object.assign([], formConfig)\n    for (let i = 0; i < formConfig.length; i++) {\n      const {require, validator, name} = formConfig[i]\n      if (!require) continue;\n      if (require && validator(result[name] || formConfig[i].defaultValue)) {\n        continue;\n      }\n\n      isError = true\n      getFormConfig[i] = {\n        ...getFormConfig[i],\n        isError: true,\n      }\n    }\n    if (!isError) {\n      const formData = new FormData();\n      if (!partName) {\n        Toast.fail(\"请选择部位\");\n        return;\n      } else {\n        formData.append('bodyType', partName);\n      }\n      for (let i of formConfig) {\n        let name = i.name\n        formData.append(name, result[name] || i.defaultValue)\n      }\n      console.log(\"result\", result)\n      setFormValue(result);\n      register_patient(formData).then(res => {\n        if (res.data.code === 200) {\n          sendRef.current?.(confirmInfo(res.data.data.id))\n        }\n      })\n\n    } else {\n      isError && setFormConfig(getFormConfig)\n    }\n  }\n  return (\n    <div className=\"choosePart\">\n      <MHeader\n        title-lg={\"磁共振成像系统\"}\n      />\n      <div className=\"formWrap\">\n        <h2>填写患者信息</h2>\n        <form>\n          <ul>\n            {\n              formConfig.map((item, index) => {\n                return (\n                  <li key={item.id}>\n                    <h4>{item.label}</h4>\n                    {\n                      item.type === 'input' ?\n                        <>\n                          <input\n                            className={item.isError ? \"err\" : \"\"}\n                            type=\"text\"\n                            defaultValue={item.defaultValue}\n                            onChange={(e) => onChange(e.target.value, item, index)}\n                            placeholder={item.placeholder}\n                            maxLength={item.maxLength}\n                          />\n                          {item.isError ? <span>{item.message}</span> : null}\n                        </>\n                        : <GenderJsx\n                          sex={formRef.current[item.name] || item.defaultValue}\n                          index={index}\n                          item={item}\n                          changeGender={onChange}\n                        />\n                    }\n                  </li>\n                )\n              })\n            }\n          </ul>\n        </form>\n      </div>\n      <div className=\"partWrap\">\n        <ul>\n          {\n            partArr.map(item => {\n              return (\n                <li key={item.id} className={partNum === item.id ? \"active\" : \"\"}\n                    onClick={choosePart.bind(null, item.id)}>\n                  <img src={item.img} alt=\"\"/>\n                  <p>{item.name_cn}</p>\n                </li>\n              )\n            })\n          }\n          <li className=\"itemEmpty\"> </li>\n          <li className=\"itemEmpty\"> </li>\n          <li className=\"itemEmpty\"> </li>\n        </ul>\n        <button onClick={submit} className=\"btn\">确认</button>\n      </div>\n    </div>\n  )\n}\n\nexport default Prepare\n","import \"./index.scss\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport {useContext, useEffect, useState} from \"react\";\nimport {get_scan_proto} from \"../../../../common/api/control\";\nimport {protocolContext} from \"../scanList\";\nimport {Toast} from \"antd-mobile\";\nimport {addProtocol} from \"../../../../common/utils\";\nconst ProtocolMenu = () => {\n\n  const {wsDataSource, sendRef} = useWsContext();\n  const [list, setList] = useState([]);\n\n  const { waitList, setWaitList} = useContext(protocolContext)\n\n  useEffect(() => {\n    if(wsDataSource?.bodyType) {\n      get_scan_proto({bodyType:wsDataSource?.bodyType}).then(res => {\n        setList(res.data.data.dataList)\n      }).catch(err => {\n        throw new Error(err)\n      })\n    }\n  }, [wsDataSource?.bodyType])\n\n  const addItem = (item) => {\n    let arr = JSON.parse(JSON.stringify(waitList));\n    let result = waitList.find(val => {\n      return val.id === item.id\n    })\n    if(result) {\n      Toast.fail(\"不能重复添加协议\");\n      return;\n    }\n    let aimArr = wsDataSource?.scanInfo\n    for (let i=0; i<aimArr.length; i++) {\n      if(aimArr[i].state === 2 || aimArr[i].state === 3) {\n        if(aimArr[i].id === item.id) {\n          Toast.fail(\"不能添加正在扫描的协议\");\n          return;\n        }\n      }\n    }\n    if(item.name === \"定位扫描\") {\n      Toast.fail(\"不能重复添加定位扫描\");\n      return\n    }\n    arr.push(item);\n    setWaitList(arr);\n    sendRef.current?.(addProtocol(wsDataSource?.userid, [item]));\n  }\n\n  return (\n    <div className={\"ProtocolMenu\"}>\n      <ul>\n        {\n          list?.map((item, index) => {\n            return (\n              <li key={item.id}>\n                <h3>{item.name}</h3>\n                <div className={\"info\"}>\n                  <span>{item.time}</span>\n                  <img src=\"/plus.png\" alt=\"\" onClick={addItem.bind(null,item, index)}/>\n                </div>\n              </li>\n            )\n          })\n        }\n      </ul>\n    </div>\n  )\n}\n\nexport default ProtocolMenu;","import {useEffect, useContext} from \"react\";\nimport {ReactSortable} from \"react-sortablejs\";\nimport {Modal} from \"antd-mobile\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport {protocolContext} from \"../scanList\";\nimport {delProtocol, handleSingleRest} from \"../../../../common/utils\";\nimport \"./index.scss\";\n\nconst alert = Modal.alert;\n\nconst ProtocolState = () => {\n  const {wsDataSource, sendRef} = useWsContext();\n  const {waitList, setWaitList} = useContext(protocolContext)\n\n  useEffect(() => {\n    let arr = [];\n    let wsArr = wsDataSource?.scanInfo;\n    if (wsArr) {\n      for (let i = 0; i < wsArr.length; i++) {\n        if (wsArr[i].state === 1) {\n          arr.push(wsArr[i])\n        }\n      }\n      setWaitList(arr);\n    }\n\n  }, [wsDataSource?.scanInfo])\n\n  const del = item => {\n    // console.log(item);\n    alert(\"删除\", `确认删除${item.name}吗?`,[\n      { text: '取消'},\n      {\n        text: '删除',\n        onPress: () => {\n          delete item.chosen\n          sendRef.current?.(delProtocol(wsDataSource?.userid, item))\n        }\n      },\n    ])\n  }\n\n  const dragEnd = (e) => {\n    console.log(waitList);\n  }\n\n  return (\n    <div className=\"protocolState\">\n      <div className=\"headerInfo\">\n        <img src=\"/sound.png\" alt=\"\"/>\n        <h2>本次扫描协议列表</h2>\n        <div className=\"tips\">\n          <img src=\"/exclamation.png\" alt=\"\"/>\n          <span>长按协议可调整扫描顺序</span>\n        </div>\n      </div>\n      <div className=\"protocolWrap\">\n        <ul>\n          {\n            wsDataSource?.scanInfo?.map(item => {\n              switch (item.state) {\n                case 5:\n                  return (\n                    <li className=\"scaned\" key={item.sequenceNo}>\n                      <div className=\"upInfo\">\n                        <span>{item.sequenceNo}</span>\n                        {/*<img src=\"/close.png\" alt=\"\"/>*/}\n                      </div>\n                      <div className=\"downInfo\">\n                        <h3>{item.name}</h3>\n                        <div className=\"processWrap\">已完成</div>\n                      </div>\n                    </li>\n                  )\n                case 2:\n                case 3:\n                  return (\n                    <li className=\"scanning\" key={item.sequenceNo}>\n                      <div className=\"upInfo\">\n                        <span>{item.sequenceNo}</span>\n                        {/*<img src=\"/close.png\" alt=\"\"/>*/}\n                      </div>\n                      <div className=\"downInfo\">\n                        <h3>{item.name}</h3>\n                        <div className=\"processWrap\">\n                          <div className=\"number\">{handleSingleRest(item.time, item.currow)}</div>\n                          <div className=\"process\" style={{width: `${(item.currow / item.totalrow) * 100}%`}}></div>\n                        </div>\n                      </div>\n                    </li>\n                  )\n              }\n            })\n          }\n          <ReactSortable\n            list={waitList}\n            setList={setWaitList}\n            onEnd={dragEnd}\n          >\n            {\n              waitList?.map((item, index) => {\n                return (\n                  <li className=\"unscan\" key={index}>\n                    <div className=\"upInfo\">\n                      <span>{item.sequenceNo}</span>\n                      <img src=\"/close.png\" alt=\"\" onClick={del.bind(null, item)}/>\n                    </div>\n                    <div className=\"downInfo\">\n                      <h3>{item.name}</h3>\n                      <div className=\"processWrap\">未扫描</div>\n                    </div>\n                  </li>\n                )\n              })\n            }\n          </ReactSortable>\n        </ul>\n      </div>\n    </div>\n  )\n}\nexport default ProtocolState;","import ProtocolMenu from \"../protocolMenu\";\nimport ProtocolState from \"../protocolState\";\nimport \"./index.scss\";\nimport {createContext, useState} from \"react\";\n\nexport const protocolContext = createContext(null);\n\n\nconst ScanList = () => {\n\n  const [waitList, setWaitList] = useState([]);\n  const [chooseIndex, setChooseIndex] = useState(0);\n  const [chooseItem, setChooseItem] = useState(null);\n\n  return (\n    <protocolContext.Provider value={{\n      chooseIndex,\n      setChooseIndex,\n      chooseItem,\n      setChooseItem,\n      waitList,\n      setWaitList\n    }}>\n      <div className={\"ScanList\"}>\n        <ProtocolState/>\n        <ProtocolMenu/>\n      </div>\n    </protocolContext.Provider>\n  )\n}\n\nexport default ScanList;","import {useContext} from \"react\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport {handleSingleRest} from \"../../../../common/utils\";\nimport {scanImageContext} from \"../scanImage\";\nimport \"./index.scss\";\n\nconst ImageMenu = () => {\n  const {wsDataSource} = useWsContext();\n  const {scanImageTab, setScanImageTab} = useContext(scanImageContext);\n\n  const chooseTab = index => {\n    setScanImageTab(index);\n  }\n\n  return (\n    <ul className=\"imageMenu\">\n      {\n        wsDataSource?.scanInfo?.map((item, index) => {\n          switch (item.state) {\n            case 5:\n              return (\n                <li\n                  className={index === scanImageTab? \"scaned active\": \"scaned\"}\n                  key={item.sequenceNo}\n                  onClick={chooseTab.bind(null, index)}\n                >\n                  <div className=\"info\">\n                    <span>{item.id}</span>\n                    <h3>{item.name}</h3>\n                  </div>\n                  <div className=\"state\">\n                    <h3>已完成</h3>\n                    <div> </div>\n                  </div>\n                  <div className=\"line\"> </div>\n                </li>\n              )\n            case 2:\n            case 3:\n              return (\n                <li\n                  className={index === scanImageTab? \"scanning active\": \"scanning\"}\n                  key={item.sequenceNo}\n                  onClick={chooseTab.bind(null, index)}\n                >\n                  <div className=\"info\">\n                    <span>{item.id}</span>\n                    <h3>{item.name}</h3>\n                  </div>\n                  <div className=\"state\">\n                    <h3>{handleSingleRest(item.time, item.currow)}</h3>\n                    <div style={{width: `${(item.currow / item.totalrow) * 100}%`}}> </div>\n                  </div>\n                  <div className=\"line\"> </div>\n                </li>\n              )\n            case 1:\n              return (\n                <li\n                  className={index === scanImageTab? \"unscan active\": \"unscan\"}\n                  key={item.sequenceNo}\n                  onClick={chooseTab.bind(null, index)}\n                >\n                  <div className=\"info\">\n                    <span>{item.id}</span>\n                    <h3>{item.name}</h3>\n                  </div>\n                  <div className=\"state\">\n                    <h3>{item.time}</h3>\n                    <div> </div>\n                  </div>\n                  <div className=\"line\"> </div>\n                </li>\n              )\n          }\n        })\n      }\n    </ul>\n  )\n}\n\nexport default ImageMenu;","const Btn = ({className, imgUrl, txt, clk}) => {\n  return (\n    <button\n      className={className}\n      onClick={clk}\n    >\n      <img src={imgUrl} alt=\"\"/>\n      <span>{txt}</span>\n    </button>\n  )\n}\nexport default Btn;","import dwv from 'dwv';\nimport {useEffect} from \"react\";\n\nconst Analysis = ({url, no, clk}) => {\n  useEffect(() => {\n    dwv.gui.getElement = dwv.gui.base.getElement;\n    const app = new dwv.App();\n    app.init({\n      containerDivId: \"dwv\"+no,\n    });\n    app.loadURLs([url])\n  },[url])\n  return (\n    <li id={\"dwv\"+no} className=\"dcm\" onClick={clk}>\n      <div className=\"layerContainer\"> </div>\n    </li>\n  )\n}\n\nexport default Analysis;","import Analysis from \"./analysis\";\n\n\nexport default function ScanDcm({dcmArr}) {\n  return (\n    <ul className=\"imageGroup\" id={\"dcmWrap\"}>\n      {\n        dcmArr?.map((item, index) => (\n          <Analysis key={item} url ={item} no={index}/>\n        ))\n      }\n    </ul>\n  )\n}","import {useContext} from \"react\";\nimport {continueScan, pauseScan} from \"../../../../common/utils\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport {scanImageContext} from \"../scanImage\";\nimport Btn from \"../btn\"\nimport isEmpty from 'lodash/isEmpty'\nimport get from 'lodash/get'\nimport ScanDcm from \"../scanDcm\";\nimport {Modal} from \"antd-mobile\"\nimport \"./index.scss\";\n\nconst alert = Modal.alert\n\nconst ImageState = () => {\n  const {wsDataSource, sendRef} = useWsContext();\n  const {scanImageTab} = useContext(scanImageContext)\n\n  const pause = () => {\n    alert('停止协议', `确认停止${wsDataSource?.scanInfo?.[scanImageTab]?.name}吗？`, [\n      { text: '取消'},\n      { text: '确认停止', onPress: () => {\n          sendRef.current?.(pauseScan(wsDataSource?.userid, [wsDataSource?.scanInfo?.[scanImageTab]]))\n        } },\n    ])\n  }\n\n  const restart = () => {\n    sendRef.current?.(continueScan(wsDataSource?.userid))\n  }\n  return (\n    <div className=\"imageState\">\n      <div className=\"info\">\n        <h3>{wsDataSource?.scanInfo?.[scanImageTab]?.name}</h3>\n        {\n          wsDataSource?.scanInfo?.[scanImageTab]?.state === 2 ?\n            <>\n              <Btn\n                className=\"restart unused\"\n                imgUrl=\"/restart2.png\"\n                txt=\"重新扫描协议\"\n              />\n              <Btn\n                className=\"pause\"\n                imgUrl=\"/pause.png\"\n                txt=\"停止协议\"\n                clk={pause}\n              />\n            </>\n            : null\n        }\n        {\n          wsDataSource?.scanInfo?.[scanImageTab]?.state === 3 ?\n            <>\n              <Btn\n                className=\"restart\"\n                imgUrl=\"/restart.png\"\n                txt=\"重新扫描协议\"\n                clk={restart}\n              />\n              <Btn\n                className=\"pause unused\"\n                imgUrl=\"/pause2.png\"\n                txt=\"停止协议\"\n              />\n            </> : null\n        }\n      </div>\n      <div className=\"ground\">\n        {\n          wsDataSource?.scanInfo?.[scanImageTab]?.state !== 5 ?\n            <img src=\"/scanning.png\" alt=\"\"/> :\n            isEmpty(get(wsDataSource, `scanInfo[${scanImageTab}].url`, []))\n              ? <img src=\"/loading.png\" alt=\"\"/> :\n              <ScanDcm dcmArr={wsDataSource?.scanInfo?.[scanImageTab]?.url}/>\n        }\n\n      </div>\n    </div>\n  )\n}\n\nexport default ImageState;","import ImageMenu from \"../imageMenu\";\nimport ImageState from \"../imageState\";\nimport \"./index.scss\";\nimport {createContext, useState} from \"react\";\n\nexport const scanImageContext = createContext(null)\n\nconst ScanImage = () => {\n\n  const [scanImageTab, setScanImageTab] = useState(0)\n\n  return (\n    <scanImageContext.Provider value={{\n      scanImageTab,\n      setScanImageTab\n    }}>\n      <div className=\"scanImage\">\n        <ImageMenu/>\n        <ImageState/>\n      </div>\n    </scanImageContext.Provider>\n  )\n}\nexport default ScanImage;","import \"./style.scss\"\nimport MHeader from \"../../common/components/m-header\";\nimport { useState} from \"react\";\nimport ScanList from \"./components/scanList\";\nimport {handleTimeStr, handleTimeNum} from \"../../common/utils\";\nimport {useWsContext} from \"../../common/encapsulation/context\";\nimport ScanImage from \"./components/scanImage\";\n\nconst ScanCheck = () => {\n  const [tabIndex, setTabIndex] = useState(\"1\");\n  const {wsDataSource} = useWsContext();\n\n  const changeTab = (e) => {\n    setTabIndex(e.target.dataset.tab)\n  }\n\n  const calRest = () => {\n    let arr = wsDataSource?.scanInfo;\n    let restTime = 0\n    for(let i=0; i<arr?.length; i++) {\n      if(arr[i].state !== 5) {\n        if(arr[i].state === 1) {\n          restTime+=handleTimeStr(arr[i].time)\n        } else {\n          restTime+=(handleTimeStr(arr[i].time)*(100-arr[i].currow))/100\n        }\n      }\n    }\n    return handleTimeNum(restTime)\n  }\n\n  const calProcess = () => {\n    let arr = wsDataSource?.scanInfo\n    let all = 0\n    let process = 0\n    let result;\n    for(let i=0; i<arr?.length; i++){\n      all+=handleTimeStr(arr[i].time)\n      if(arr[i].state ===5) {\n        process+=handleTimeStr(arr[i].time)\n      }else if(arr[i].state ===2|| arr[i].state ===3) {\n        process+=handleTimeStr(arr[i].time)*(arr[i].currow/arr[i].totalrow)\n      }\n    }\n    result = (process/all)* 100\n    return result\n  }\n\n  return (\n    <div className=\"scanCheck\">\n      <MHeader\n        uid = {wsDataSource?.userid}\n        timer\n        loading ={calProcess()}\n        close\n        timerTitle=\"剩余总时长\"\n        timerNum={calRest()}\n      >\n        <ul className=\"tabs\">\n          <li className={\"1\" === tabIndex ? \"active\" : \"\"} onClick={changeTab} data-tab=\"1\">协议列表<b> </b></li>\n          <li className={\"2\" === tabIndex ? \"active\" : \"\"} onClick={changeTab} data-tab=\"2\">扫查影像<b> </b></li>\n        </ul>\n      </MHeader>\n      <div className=\"content\">\n        {\n          \"1\" === tabIndex ? <ScanList/> : <ScanImage/>\n        }\n      </div>\n    </div>\n  )\n}\n\nexport default ScanCheck","import {ReactSortable} from \"react-sortablejs\";\nimport MHeader from \"../../common/components/m-header\";\nimport {useEffect, useState} from \"react\";\nimport {get_scan_proto} from \"../../common/api/control\";\nimport {Toast} from \"antd-mobile\";\nimport {useWsContext} from \"../../common/encapsulation/context\";\nimport {useSafeImplement} from '../../common/hooks';\nimport {beginScan, handleTimeNum, handleTimeStr} from \"../../common/utils\"\nimport \"./style.scss\";\n\nconst ProtocolList = () => {\n  const {wsDataSource, setRouterPath, sendRef} = useWsContext();\n  const [protocolList, setProtocolListPre] = useState([]);\n  const [protocolBlockState, setProtocolBlockStatePre] = useState([]);\n  const [fix, setFixPre] = useState({});\n  const [time, setTime] = useState(0);\n\n  const setProtocolList = useSafeImplement(setProtocolListPre)\n  const setProtocolBlockState = useSafeImplement(setProtocolBlockStatePre)\n  const setFix = useSafeImplement(setFixPre)\n\n  // console.log(wsDataSource?.check_info?.bodyType)\n\n\n  useEffect(() => {\n    if (wsDataSource?.bodyType) {\n      get_scan_proto({\n        bodyType: wsDataSource?.bodyType\n      }).then(res => {\n        let result = res.data.data.dataList;\n        let lArr = [];\n        let rArr = []\n        for (let i = 0; i < result.length; i++) {\n          if (result[i].name === \"定位扫描\") {\n            setFix(result[i])\n            setTime(time + handleTimeStr(result[i].time));\n          } else {\n            if (result[i].protoType === \"buildin\") {\n              lArr.push(result[i]);\n            } else {\n              rArr.push(result[i]);\n            }\n          }\n        }\n        setProtocolBlockState(lArr)\n        setProtocolList(rArr)\n      })\n    }\n  }, [wsDataSource])\n\n  const addItem = (item) => {\n    console.log(item)\n    let arr = [...protocolBlockState];\n    for (let i = 0; i < arr.length; i++) {\n      if (arr[i].id === item.id) {\n        Toast.fail(\"已添加该项\");\n        return;\n      }\n    }\n    item.currow = 0;\n    arr.push(item);\n    setProtocolBlockState(arr);\n    setTime(time + handleTimeStr(item.time));\n  }\n\n  const delItem = (item, index) => {\n    console.log(item)\n    let arr = [...protocolBlockState];\n    arr.splice(index, 1)\n    setProtocolBlockState(arr);\n    setTime(time - handleTimeStr(item.time));\n  }\n\n  const beginCheck = () => {\n    let result = protocolBlockState\n    result.unshift(fix)\n    if (result.length === 0) {\n      Toast.fail(\"未选择任何协议\");\n      return;\n    }\n    sendRef.current?.(beginScan(wsDataSource?.userid, result))\n    setRouterPath(\"Scanning\");\n  }\n  const initProtocol = () => {\n    let arr = protocolBlockState;\n    let timeResult = time;\n    for (let i = 0; i < arr.length; i++) {\n      timeResult -= handleTimeStr(arr[i].time)\n    }\n    setTime(timeResult)\n    setProtocolBlockState([])\n  }\n\n  return (\n    <div className=\"protocolList\">\n      <MHeader\n        title-lg={wsDataSource?.bodyTypeCn}\n        timer\n        timerTitle=\"剩余总时长\"\n        timerNum={handleTimeNum(time)}\n      />\n      <div className=\"listContent\">\n        <div className=\"lPart\">\n          <div className=\"up\">\n            <div className=\"topInfo\">\n              <div className=\"l\">\n                <img src=\"/sound.png\" alt=\"\"/>\n                <h3>本次扫描协议列表</h3>\n              </div>\n              <div className=\"r\">\n                <img src=\"/exclamation.png\" alt=\"\"/>\n                <h4>长按协议可调整扫描顺序</h4>\n              </div>\n            </div>\n            <ul className=\"protocolBlocks\">\n              <li>\n                <div className=\"upInfo\">\n                  <div className=\"sort\">1</div>\n                </div>\n                <div className=\"content\">\n                  <h4>{fix.name}</h4>\n                  <div className=\"timer\">{fix.time}</div>\n                </div>\n              </li>\n              <ReactSortable\n                list={protocolBlockState}\n                setList={setProtocolBlockState}\n                dragClass='chosen-class'\n                ghostClass='chosen-class'\n                chosenClass='chosen-class'\n              >\n                {\n                  protocolBlockState.map((item, index) => {\n                    return (\n                      <li key={item.id}>\n                        <div className=\"upInfo\">\n                          <div className=\"sort\">{index + 2}</div>\n                          {\n                            item.protoType === \"buildin\" ? null :\n                              <img src=\"/close.png\" alt=\"\" className=\"close\" onClick={delItem.bind(null, item, index)}/>\n                          }\n                        </div>\n                        <div className=\"content\">\n                          <h4>{item.name}</h4>\n                          <div className=\"timer\">{item.time}</div>\n                        </div>\n                      </li>\n                    )\n                  })\n                }\n              </ReactSortable>\n            </ul>\n          </div>\n          <div className=\"down\">\n            <button className=\"lBtn\" onClick={beginCheck}>开始检查</button>\n            <button className=\"rBtn\" onClick={initProtocol}>恢复默认协议</button>\n          </div>\n        </div>\n        <div className=\"rPart\">\n          <ul>\n            {\n              protocolList.map(item => {\n                return (\n                  <li key={item.id}>\n                    <div className=\"name\">{item.name}</div>\n                    <img src=\"/plus.png\" alt=\"\" className=\"plus\" onClick={addItem.bind(null, item)}/>\n                    <div className=\"time\">{item.time}</div>\n                  </li>\n                )\n              })\n            }\n          </ul>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ProtocolList;\n","const Test = () => {\n  return (\n    <>\n      <div id=\"tags\"> </div>\n    </>\n  )\n}\n\nexport default Test;","import {useContext} from \"react\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport {completedContext} from \"../../index\";\nimport \"./index.scss\";\n\nconst ProtocolMenu = () => {\n  const {wsDataSource} = useWsContext();\n  const {tabIndex, setTabIndex} = useContext(completedContext);\n\n  const handleClk = index => {\n    setTabIndex(index);\n  }\n\n  return (\n    <ul className=\"protocolMenu\">\n      {\n        wsDataSource?.scanInfo.map((item, index) => {\n          return (\n            <li\n              key={item.sequenceNo}\n              className={tabIndex === index ? \"active\" : \"\"}\n              onClick={handleClk.bind(null, index)}\n            >\n              <span>{item.sequenceNo}</span>\n              <h3>{item.name}</h3>\n              <div className=\"line\"> </div>\n            </li>\n          )\n        })\n      }\n    </ul>\n  )\n}\n\nexport default ProtocolMenu;","import \"./index.scss\";\n\nconst Tip = ({setTip}) => {\n  const know = () => {\n    setTip(false)\n  }\n  return (\n    <div className=\"tip\">\n      <h1>滑动调节窗宽窗位</h1>\n      <img src=\"/swipe.png\" alt=\"\"/>\n      <button onClick={know}>我知道了</button>\n    </div>\n  )\n}\n\nexport default Tip;","import dwv from 'dwv';\nimport {useEffect, useState} from \"react\";\nimport {get_tag} from \"../../../../common/api/control\";\nimport \"./index.scss\";\nimport Tip from \"../tip\";\n\nconst DcmDetail = ({url, dcmShow, setDcmShow, changeDcm}) => {\n  const [info, setInfo] = useState(null);\n  const [tip, setTip] = useState(false);\n\n  useEffect(() => {\n    init();\n    analysis(url);\n    get_tag(url).then(event => {\n      const dicomParser = new dwv.dicom.DicomParser();\n      dicomParser.parse(event.data);\n      const rawTags = dicomParser.getRawDicomElements();\n      setInfo(rawTags)\n    })\n    checkTip();\n  }, [url]);\n\n  const handleDcmDetail = () => {\n    setDcmShow(false)\n  }\n\n  const analysis = (url) => {\n    dwv.gui.getElement = dwv.gui.base.getElement;\n    const app = new dwv.App();\n    app.init({\n      containerDivId: \"dwv\",\n      tools : {\n        WindowLevel: {}\n      }\n    });\n    app.addEventListener(\"load\", function () {\n      app.setTool(\"WindowLevel\");\n    });\n    app.loadURLs([url])\n  }\n\n  const init = () => {\n    let element = document.getElementById(\"parentNode\");\n    if(element) {\n      while (element.firstChild) {\n        element.removeChild(element.firstChild);\n      }\n    }\n  }\n\n  const switchDcm = (val, e) => {\n    e.stopPropagation()\n    changeDcm(val)\n  }\n\n  const checkTip = () => {\n    const result = localStorage.getItem(\"tip\");\n    if(!result) {\n      setTip(true);\n      localStorage.setItem(\"tip\", \"true\");\n    }\n  }\n\n  return (\n    <>\n      {dcmShow ?\n        <div className=\"dcmDetail\" onClick={handleDcmDetail}>\n          <div className=\"detail\">\n            <div className=\"tl info\">\n              <p>\n                {info?.[\"x00100010\"]?.value[0]?info?.[\"x00100010\"]?.value[0]: \"\"}\n                , {info?.[\"x00100040\"]?.value[0]?info?.[\"x00100040\"]?.value[0]: \"\"}\n              </p>\n              <p>\n                {info?.[\"x0008103E\"]?.value[0]? info?.[\"x0008103E\"]?.value[0]: \"\"}\n                , {info?.[\"x00080021\"]?.value[0]? info?.[\"x00080021\"]?.value[0]: \"\"}\n              </p>\n              <p>\n                {info?.[\"x00281050\"]?.value[0]?`WL: ${info?.[\"x00281050\"]?.value[0]}`: \"\"}\n                {info?.[\"x00281051\"]?.value[0]?`, WW: ${info?.[\"x00281051\"]?.value[0]}`: \"\"}\n              </p>\n            </div>\n            <div className=\"tr info\">\n              <p>{info?.[\"x00080070\"]?.value[0]?info?.[\"x00080070\"]?.value[0]: \"\"}</p>\n              <p>{info?.[\"x00080060\"]?.value[0]?info?.[\"x00080060\"]?.value[0]: \"\"}</p>\n            </div>\n            <div className=\"bl info\">\n              <p>{info?.[\"x00181030\"]?.value[0]? info?.[\"x00181030\"]?.value[0]: \"\"}</p>\n              <p>{info?.[\"x00180080\"]?.value[0]?`TR: ${info?.[\"x00180080\"]?.value[0]} ms`: \"\"}</p>\n              <p>{info?.[\"x00180081\"]?.value[0]?`TE: ${info?.[\"x00180081\"]?.value[0]} ms`: \"\"}</p>\n              <p>{info?.[\"x00180087\"]?.value[0]?`Field: ${info?.[\"x00180087\"]?.value[0]} T`: \"\"}</p>\n              <p>{info?.[\"x00181314\"]?.value[0]?`Flip Angle: ${info?.[\"x00181314\"]?.value[0]}°`: \"\" }</p>\n            </div>\n            <div className=\"br info\">\n              <p>{info?.[\"x00180050\"]?.value[0]? `Slice Thk: ${info?.[\"x00180050\"]?.value[0]} mm`: \"\"}</p>\n              <p>\n                {info?.[\"x00280010\"]?.value[0]?`Res: ${info?.[\"x00280010\"]?.value[0]} `: \"\"}\n                {info?.[\"x00280011\"]?.value[0]?`X ${info?.[\"x00280011\"]?.value[0]}`: \"\"}\n              </p>\n            </div>\n            <div id=\"dwv\" className=\"dcm\">\n              <div className=\"layerContainer\" id=\"parentNode\"> </div>\n            </div>\n          </div>\n          <img src=\"/left.png\" alt=\"\" className=\"prev\" onClick={switchDcm.bind(null, \"prev\")}/>\n          <img src=\"/right.png\" alt=\"\" className=\"next\" onClick={switchDcm.bind(null, \"next\")}/>\n        </div>\n        : null}\n      {\n        tip?<Tip setTip = {setTip}/>:null\n      }\n    </>\n\n  )\n}\n\nexport default DcmDetail;","import {useContext, useEffect, useState} from \"react\";\nimport { Toast} from 'antd-mobile';\nimport {completedContext} from \"../../index\";\nimport {useWsContext} from \"../../../../common/encapsulation/context\";\nimport Analysis from \"../../../Scanning/components/analysis\";\nimport DcmDetail from \"../dcmDetail\";\nimport {completed} from \"../../../../common/api/control\";\nimport \"./index.scss\";\n\nconst ProtocolSpace = () => {\n  const {wsDataSource, setFormValue, setRouterPath} = useWsContext();\n  const {tabIndex} = useContext(completedContext);\n  const [dcmShow, setDcmShow] = useState(false);\n  const [url, setUrl] = useState(\"\");\n  const [urlIndex, setUrlIndex] = useState(\"\");\n  const [maxLength, setMaxLength] = useState(0)\n\n  useEffect(() => {\n    setMaxLength(wsDataSource?.scanInfo?.[tabIndex]?.url.length);\n  }, [tabIndex])\n\n  const handleDcm = (item, index) => {\n    setDcmShow(true);\n    setUrlIndex(index);\n    setUrl(item);\n  }\n\n  const changeDcm = (val) => {\n    if(val === \"prev\") {\n      if(urlIndex-1> -1) {\n        setUrlIndex(urlIndex-1)\n        setUrl(wsDataSource?.scanInfo?.[tabIndex]?.url?.[urlIndex-1]);\n      }else {\n        Toast.success(\"已经是第一张了\", 1.2);\n      }\n    }else if(val === \"next\") {\n      if(urlIndex+1< maxLength) {\n        setUrlIndex(urlIndex+1)\n        setUrl(wsDataSource?.scanInfo?.[tabIndex]?.url?.[urlIndex+1]);\n      }else {\n        Toast.success(\"已经是最后一张了\", 1.2);\n      }\n    }\n  }\n\n  const next = () => {\n    completed().then(res => {\n      console.log(res);\n    }).catch(err => {\n      throw new Error(err);\n    })\n    setFormValue(null);\n    setRouterPath('Prepare');\n  }\n\n  const present = () => {\n    completed().then(res => {\n      console.log(res);\n    }).catch(err => {\n      throw new Error(err);\n    })\n    setRouterPath('Prepare');\n  }\n\n  return (\n    <div className=\"protocolSpace\">\n      <div className=\"title\">\n        <h2>{wsDataSource?.scanInfo?.[tabIndex].name}</h2>\n        <button>\n          <img src=\"/exclamation.png\" alt=\"\"/>\n          <span>点击查看大图</span>\n        </button>\n      </div>\n      <div className=\"space\">\n        <ul>\n          {\n            wsDataSource?.scanInfo?.[tabIndex]?.url.map((item, index) => {\n              return (\n                <Analysis\n                  key={item}\n                  url={item}\n                  no={index}\n                  clk={handleDcm.bind(null, item, index)}\n                />\n              )\n            })\n          }\n        </ul>\n      </div>\n      <div className=\"handle\">\n        <button className=\"next\" onClick={next}>检查下一个患者</button>\n        <button className=\"present\" onClick={present}>继续检查当前患者</button>\n      </div>\n      {\n        dcmShow?<DcmDetail\n          url={url}\n          dcmShow={dcmShow}\n          setDcmShow={setDcmShow}\n          changeDcm = {changeDcm}\n        />: null\n      }\n\n    </div>\n  )\n}\n\nexport default ProtocolSpace;","import {createContext, useState} from \"react\";\nimport MHeader from \"../../common/components/m-header\";\nimport {useWsContext} from \"../../common/encapsulation/context\";\nimport ProtocolMenu from \"./components/protocolMenu\";\nimport ProtocolSpace from \"./components/protocolSpace\";\nimport \"./style.scss\";\n\nexport const completedContext = createContext(null);\n\nconst Completed = () => {\n  const {wsDataSource} = useWsContext();\n  const [tabIndex, setTabIndex] = useState(0);\n\n  return (\n    <completedContext.Provider value={{\n      tabIndex,\n      setTabIndex\n    }}>\n      <div className=\"completed\">\n        <MHeader\n          title-lg = {wsDataSource?.bodyTypeCn}\n        />\n        <div className=\"content\">\n          <ProtocolMenu/>\n          <ProtocolSpace/>\n        </div>\n      </div>\n    </completedContext.Provider>\n  )\n}\n\nexport default Completed;","import {\n  Switch,\n  Route,\n  useHistory\n} from \"react-router-dom\";\nimport Prepare from \"./pages/Prepare\";\nimport ScanCheck from \"./pages/Scanning\";\nimport Plan from \"./pages/Plan\"\nimport Test from \"./pages/test\"\nimport Context, {useWsContext} from \"./common/encapsulation/context\";\nimport {useEffect} from \"react\";\nimport Completed from \"./pages/Completed\";\n\nfunction Wrap() {\n\n  const history = useHistory();\n  const {routerPath} = useWsContext();\n\n  useEffect(() => {\n\n    history.push(`/${routerPath}`)\n  }, [routerPath,history])\n\n  return (\n    <div className=\"App\">\n      <Switch>\n        <Route path=\"/Scanning\">\n          <ScanCheck/>\n        </Route>\n        <Route path=\"/Prepare\">\n          <Prepare/>\n        </Route>\n        <Route path=\"/Plan\">\n          <Plan/>\n        </Route>\n        <Route path=\"/Completed\">\n          <Completed/>\n        </Route>\n        <Route path=\"/Test\">\n          <Test/>\n        </Route>\n      </Switch>\n    </div>\n  );\n}\n\nconst App = () => (\n  <Context>\n    <Wrap/>\n  </Context>\n)\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport \"./index.scss\"\n\nimport {\n  BrowserRouter as Router,\n} from \"react-router-dom\";\n\n\nReactDOM.render(\n  <Router>\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>\n  </Router>\n  ,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}